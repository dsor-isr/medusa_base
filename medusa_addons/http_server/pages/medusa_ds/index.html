<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:v="urn:schemas-microsoft-com:vml">
<head>
<title>MedusaDS Homepage</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<!-- <meta http-equiv="refresh" content="4"></meta> -->
<style type="text/css">
.fancy_button {
    -moz-box-shadow:inset 0px 1px 0px 0px #ffffff;
    -webkit-box-shadow:inset 0px 1px 0px 0px #ffffff;
    box-shadow:inset 0px 1px 0px 0px #ffffff;
    background:-webkit-gradient( linear, left top, left bottom, color-stop(0.05, #ededed), color-stop(1, #dfdfdf) );
    background:-moz-linear-gradient( center top, #ededed 5%, #dfdfdf 100% );
    filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#ededed', endColorstr='#dfdfdf');
    background-color:#ededed;
    -moz-border-radius:6px;
    -webkit-border-radius:6px;
    border-radius:6px;
    border:1px solid #dcdcdc;
    display:inline-block;
    color:#0000ff;
    font-family:arial;
    font-size:15px;
    font-weight:bold;
    width:99%;
    text-align: center;
    vertical-align: middle;
    text-decoration:none;
    text-shadow:1px 1px 0px #ffffff;
}.fancy_button:hover {
    background:-webkit-gradient( linear, left top, left bottom, color-stop(0.05, #dfdfdf), color-stop(1, #ededed) );
    background:-moz-linear-gradient( center top, #dfdfdf 5%, #ededed 100% );
    filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#dfdfdf', endColorstr='#ededed');
    background-color:#dfdfdf;
}.fancy_button:active {
    position:relative;
    top:1px;
}
p {
    margin: 0;
    padding: 0;
}
#logoDiv {
	position: absolute;
	visibility:visible;
	z-index:5;
	top: 0%;
	right: 0%;
    font-family: Arial, Helvetica, sans-serif;
  	cursor: hand;
  	border-radius: 5px;
  	background-color: #FFFFFF;
	border: 1px solid black;
}

#dsor_logo { background-image: url('logos/dsor_logo.jpg'); }
.dsor_logo { width: 42px;  }
#isr_logo { background-image: url('logos/isr_logo.png'); }
.isr_logo { width: 34px; }
#ist_logo { background-image: url('logos/ist_logo.png'); }
.ist_logo { width: 39px;  }

.logos {
  border-style: solid;
  border-width: 0px;
  padding-top:0;
  background-size: 100% 100%;
  height: 50px;
  text-align: right;
}

.fields {
    display: inline-block;
}
/* This imageless css button was generated by CSSButtonGenerator.com */
</style>
    <script>
        var varstoaks=["Safety_Feature", "lower/bat_monit/data", "lower/thrusterHR/data", "lower/thrusterHL/data", "lower/thrusterVB/data", "lower/thrusterVF/data", "upper/gps/data", "upper/imu/data", "upper/inside_pressure/data", "lower/inside_pressure/data", "upper/outside_pressure/data", "can/motor_port", "can/motor_stbd", "lower/altimeter/data", "lower/altimeter/temperature", "upper/leaks/front","upper/leaks/back","lower/leaks/front", "lower/leaks/back", "lower/dvl/attitude"];
        function topics_list(){
        	this.topics={};
        	this.addTopic = function(obj_topic){
        		this.topics[obj_topic.name]=obj_topic;
        	}
        }

        function topic(name){
        	this.name=name;
        	this.subtopics = {};
        	this.addSubTopic = function(name,fcn){
        		this.subtopics[name]=fcn;
        	}
        }

        var topics_list = new topics_list();

        var ufleak = new topic("upper_leaks_front");
        ufleak.addSubTopic('data',"ufleak");
        topics_list.addTopic(ufleak);
        var ubleak = new topic("upper_leaks_back");
        ubleak.addSubTopic('data',"ubleak");
        topics_list.addTopic(ubleak);
        var lfleak = new topic("lower_leaks_front");
        lfleak.addSubTopic('data',"lfleak");
        topics_list.addTopic(lfleak);
        var lbleak = new topic("lower_leaks_back");
        lbleak.addSubTopic('data',"lbleak");
        topics_list.addTopic(lbleak);

        var bat = new topic("lower_bat_monit_data");
        bat.addSubTopic('charging',"pbatcharging");
        bat.addSubTopic('min_temp',"pbatmin_temp");
        bat.addSubTopic('max_temp',"pbatmax_temp");
        bat.addSubTopic('min_cell',"pbatmin_cell");
        bat.addSubTopic('max_cell',"pbatmax_cell");
        bat.addSubTopic('current',"pbatact_curr");
        bat.addSubTopic('number_of_packs',"pbatnum_packs");
        topics_list.addTopic(bat);

        var imu = new topic("upper_imu_data");
        imu.addSubTopic('Yaw',"pimuheading");
        imu.addSubTopic('Roll',"pimuroll");
        imu.addSubTopic('Pitch',"pimupitch");
        imu.addSubTopic('Gz',"pimuheading_rate");
        imu.addSubTopic('Gx',"pimuroll_rate");
        imu.addSubTopic('Gy',"pimupitch_rate");
        topics_list.addTopic(imu);

        var depth = new topic("upper_outside_pressure_data");
        depth.addSubTopic('pressure',"poutpres_pressure");
        depth.addSubTopic('temperature',"poutprestemperature");
        topics_list.addTopic(depth);

        var uinp = new topic("upper_inside_pressure_data");
        uinp.addSubTopic('pressure',"upinside_pressure");
        uinp.addSubTopic('temperature',"uptemperature");
        topics_list.addTopic(uinp);

        var linp = new topic("lower_inside_pressure_data");
        linp.addSubTopic('pressure',"lpinside_pressure");
        linp.addSubTopic('temperature',"lptemperature");
        topics_list.addTopic(linp);

        var lalt = new topic("lower_altimeter_data");
        lalt.addSubTopic('data',"paltdata");
        topics_list.addTopic(lalt);

        var lalttemp = new topic("lower_altimeter_temperature");
        lalttemp.addSubTopic('data',"palttemp");
        topics_list.addTopic(lalttemp);

        var gps = new topic("upper_gps_data");
        gps.addSubTopic('satellites',"pgsats");
        gps.addSubTopic('latitude',"pglat");
        gps.addSubTopic('longitude',"pglon");
        gps.addSubTopic('mode',"pgmode");
        topics_list.addTopic(gps);

        var thl = new topic("lower_thrusterHL_data");
        thl.addSubTopic('Speed',"plm_speed");
        thl.addSubTopic('Current',"plm_curr");
        thl.addSubTopic('Temperature',"plm_temp");
        thl.addSubTopic('Errors',"plm_errors");
        topics_list.addTopic(thl);

        var thr = new topic("lower_thrusterHR_data");
        thr.addSubTopic('Speed',"prm_speed");
        thr.addSubTopic('Current',"prm_curr");
        thr.addSubTopic('Temperature',"prm_temp");
        thr.addSubTopic('Errors',"prm_errors");
        topics_list.addTopic(thr);

        var thvb = new topic("lower_thrusterVB_data");
        thvb.addSubTopic('Speed',"pvbm_speed");
        thvb.addSubTopic('Current',"pvbm_curr");
        thvb.addSubTopic('Temperature',"pvbm_temp");
        thvb.addSubTopic('Errors',"pvbm_errors");
        topics_list.addTopic(thvb);

        var thvf = new topic("lower_thrusterVF_data");
        thvf.addSubTopic('Speed',"pvfm_speed");
        thvf.addSubTopic('Current',"pvfm_curr");
        thvf.addSubTopic('Temperature',"pvfm_temp");
        thvf.addSubTopic('Errors',"pvfm_errors");
        topics_list.addTopic(thvf);

        var dvl = new topic("lower_dvl_attitude");
        dvl.addSubTopic('z',"pdvl_heading");
        dvl.addSubTopic('x',"pdvl_roll");
        dvl.addSubTopic('y',"pdvl_pitch");
        topics_list.addTopic(dvl);

        function clearFields(){
			for(var topic in topics_list.topics){
				for(var subtopic in topics_list.topics[topic].subtopics){
                    console.log(topics_list.topics[topic].subtopics[subtopic]);
                    console.log(document.getElementById(topics_list.topics[topic].subtopics[subtopic]));
					document.getElementById(topics_list.topics[topic].subtopics[subtopic]).innerHTML = "NA";
				}
			}
        }

        function checkFields(topic, subtopic, text){
        	if(topics_list.topics[topic]  && topics_list.topics[topic].subtopics[subtopic])
                if(isNaN(parseFloat(text)))
                    document.getElementById(topics_list.topics[topic].subtopics[subtopic]).innerHTML = '  ' + text;
                else
        		  document.getElementById(topics_list.topics[topic].subtopics[subtopic]).innerHTML = '  ' + parseFloat(text).toFixed(2)+'';
        }

        function readXML(xmlhttp) {
            //console.log("readXML");
            if(xmlhttp.readyState == 4 && xmlhttp.status==200){
            	clearFields();
                xmlDoc=xmlhttp.responseXML;
                if (xmlDoc){
                    if(xmlDoc.getElementsByTagName("ROSMessage").length!=0){
                        var rosmsg = xmlDoc.getElementsByTagName("ROSMessage");
                        var rosn   = rosmsg.length;
                        var seq_num = 0;
                        for(var i=0;i<rosn;i++){
                        	name_nodeValue = rosmsg[i].attributes.getNamedItem("name").value;

                        	var var_elements = rosmsg[i].getElementsByTagName("KEY");
			                for(var j=0;j<var_elements.length;j++){
			                	var subtopic = "";
			                	var topicvalue = "";
			                	if(var_elements[j].textContent){
			                		subtopic = var_elements[j].textContent;
			                		topicvalue = rosmsg[i].getElementsByTagName("DOUBLE")[j].textContent;
			                	}else{ // IE
			                		subtopic = var_elements[j].text;
			                		topicvalue = rosmsg[i].getElementsByTagName("DOUBLE")[j].text;
			                	}

			                	checkFields(name_nodeValue, subtopic, topicvalue);
			                }
                        }
                    }
                }
            }
            xmlhttp.abort();
        }
        function askVars(){
        	createHTTPreq();
            if(xmlhttp){
            	//xmlhttp.abort();
                xmlhttp.open("GET","/VAR%20" +varstoaks.join("%20"),true);
            	xmlhttp.setRequestHeader("If-Modified-Since", "Sat, 1 Jan 2005 00:00:00 GMT");
                requestTimer = setTimeout(function() {
                	if (xmlhttp.readyState == 4 && xmlhttp.status == 200) readXML(xmlhttp);
                    xmlhttp.abort();
                }, 800);
                xmlhttp.send();
            }
        }
        function init(){
            setInterval("askVars();",1000);
        }

        var requestTimer ;
        var xmlhttp;

        function getXMLHttpRequest()
		{
		    if (window.XMLHttpRequest) {// code for IE7+, Firefox, Chrome, Opera, Safari
		        return new window.XMLHttpRequest;
		    } else {// code for IE6, IE5
		        try {
		            return new ActiveXObject("MSXML2.XMLHTTP.3.0");
		        }
		        catch(ex) {
		            return null;
		        }
		    }
		}

		function createHTTPreq(){
			xmlhttp = getXMLHttpRequest();

	        if (xmlhttp){
        		xmlhttp.onreadystatechange = function() {
	                if (xmlhttp.readyState != 4)
	                    return;

	                clearTimeout(requestTimer);
	                if (xmlhttp.status != 200){
	                    xmlhttp.abort();
	                    return;
	                }
	                readXML(xmlhttp);
	        	};
	        }
		}
/*        //Http Requester
        if (window.XMLHttpRequest){// code for IE7+, Firefox, Chrome, Opera, Safari
            xmlhttp = new XMLHttpRequest();
        }else{// code for IE6, IE5
            xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
        }
        if (xmlhttp){
        	xmlhttp.onreadystatechange = function() {
                if (xmlhttp.readyState != 4)
                    return;

                clearTimeout(requestTimer);
                if (xmlhttp.status != 200){
                    xmlhttp.abort();
                    return;
                }
                readXML(xmlhttp);
        	};
        }*/
    </script>
</head>
<body onload="init();">
	  <div id="logoDiv">
	    <table id="table_header" border="0" cellspacing="0" cellpadding="0" style="width: 100%">
	    	<tr>
	        <td class="dsor_logo"><div class="logos buttons_header" id="dsor_logo" title="DSOR Logo" ></div></td>
	        <td class="isr_logo"><div class="logos buttons_header" id="isr_logo" title="ISR Logo" > </div></td>
	        <td class="ist_logo"><div class="logos buttons_header" id="ist_logo" title="IST Logo" ></div></td>
	        </tr>
	    </table>
	  </div>
	<center>
	<h1>MedusaDS Homepage</h1>
	<font color=red><p id="safety"></p></font>
    </center>
    <h2>Housings</h2>
    <div style="vertical-align:top;display:inline-block; width: 300px; padding-left: 50;">
        <h3>Upper Housing</h3>
        <ul>
            <li><p class="fields">Pressure:</p><p class="fields" id="upinside_pressure">NA</p><p class="fields">mBar</p></li>
            <li><p class="fields">Temperature:</p><p class="fields" id="uptemperature">NA</p><p class="fields">ºC</p></li>
            <li><p class="fields">Front Leak:</p><p class="fields" id="ufleak">NA</p></li>
            <li><p class="fields">Back Leak:</p><p class="fields" id="ubleak">NA</p></li>
        </ul>
    </div>
    <div style="vertical-align:top; display:inline-block; width: 300px;">
        <h3>Lower Housing</h3>
        <ul>
            <li><p class="fields">Pressure:</p><p class="fields" id="lpinside_pressure">NA</p><p class="fields">mBar</p></li>
            <li><p class="fields">Temperature:</p><p class="fields" id="lptemperature">NA</p><p class="fields">ºC</p></li>
            <li><p class="fields">Front Leak:</p><p class="fields" id="lfleak">NA</p></li>
            <li><p class="fields">Back Leak:</p><p class="fields" id="lbleak">NA</p></li>
        </ul>
    </div>
    <div style="vertical-align:top; display:inline-block; width: 300px;">
        <h3>Actions</h3>
        <p style="width:300px">
            <a class='fancy_button' href="./RSET pc_shutdown std_msgs/Empty {}" >Shutdown PC</a>
        </p>
        <p style="width:300px">
            <a class='fancy_button' href="./RSET lower/bat_monit/shutdown std_msgs/Empty {}" >Power Shutdown</a>
        </p>
        <p style="width:300px">
            <a class='fancy_button' href="./RSET lower/bat_monit/power_reboot std_msgs/Empty {}" >Power Reboot</a>
        </p>
        <p style="width:300px">
            <a class='fancy_button' href="./RSET lower/thruster_wash std_msgs/Bool true" >Wash Thrusters</a>
        </p>
        <p style="width:300px">
            <a class='fancy_button' href="./RSET lower/thruster_test std_msgs/Bool true" >Test Thrusters</a>
        </p>
    </div>
    <h2>Thrusters</h2>
    <br>
    <div style="display:inline-block; width: 200px;">
        <h3>Horizontal Portside</h3>
        <ul>
            <li><p class="fields">Speed:</p><p class="fields" id="plm_speed">NA</p><p class="fields">rpm</p></li>
            <li><p class="fields">Current:<p class="fields" id="plm_curr">NA</p><p class="fields">mA</p></li>
            <li><p class="fields">Temperature:<p class="fields" id="plm_temp">NA</p><p class="fields">ºC</p></li>
            <li><p class="fields">Faults:<p class="fields" id="plm_errors">NA</p></li>
        </ul>
    </div>
    <div style="display:inline-block; width: 200px;">
        <h3>Horizontal Starboard</h3>
        <ul>
            <li><p class="fields">Speed:</p><p class="fields" id="prm_speed">NA</p><p class="fields">rpm</p></li>
            <li><p class="fields">Current:<p class="fields" id="prm_curr">NA</p><p class="fields">mA</p></li>
            <li><p class="fields">Temperature:<p class="fields" id="prm_temp">NA</p><p class="fields">ºC</p></li>
            <li><p class="fields">Faults:<p class="fields" id="prm_errors">NA</p></li>
        </ul>
    </div>
    <div style="display:inline-block; width: 200px;">
        <h3>Vertical Back</h3>
        <ul>
            <li><p class="fields">Speed:</p><p class="fields" id="pvbm_speed">NA</p><p class="fields">rpm</p></li>
            <li><p class="fields">Current:<p class="fields" id="pvbm_curr">NA</p><p class="fields">mA</p></li>
            <li><p class="fields">Temperature:<p class="fields" id="pvbm_temp">NA</p><p class="fields">ºC</p></li>
            <li><p class="fields">Faults:<p class="fields" id="pvbm_errors">NA</p></li>
        </ul>
    </div>
    <div style="display:inline-block; width: 200px;">
        <h3>Vertical Front</h3>
        <ul>
            <li><p class="fields">Speed:</p><p class="fields" id="pvfm_speed">NA</p><p class="fields">rpm</p></li>
            <li><p class="fields">Current:<p class="fields" id="pvfm_curr">NA</p><p class="fields">mA</p></li>
            <li><p class="fields">Temperature:<p class="fields" id="pvfm_temp">NA</p><p class="fields">ºC</p></li>
            <li><p class="fields">Faults:<p class="fields" id="pvfm_errors">NA</p></li>
        </ul>
    </div>
    <h2>Sensors</h2>
    <div style="display:inline-block; width: 200px;vertical-align:top;">
        <h3>GPS</h3>
        <ul>
            <li><p class="fields">Mode:</p><p class="fields" id="pgmode">NA</p></li>
            <li><p class="fields">Sattelites:</p><p class="fields" id="pgsats">NA</p></li>
            <li><p class="fields">Latitude:</p><p class="fields" id="pglat">NA</p></li>
            <li><p class="fields">Longitude:</p><p class="fields" id="pglon">NA</p></li>
        </ul>
    </div>
    <div style="display:inline-block; width: 200px; vertical-align:top;">
        <h3>IMU</h3>
        <ul>
            <li><p class="fields">Heading:</p><p class="fields" id="pimuheading">NA</p><p class="fields">º</p></li>
            <li><p class="fields">Pitch:</p><p class="fields" id="pimupitch">NA</p><p class="fields">º</p></li>
            <li><p class="fields">Roll:</p><p class="fields" id="pimuroll">NA</p><p class="fields">º</p></li>
            <li><p class="fields">Heading Rate:</p><p class="fields" id="pimuheading_rate">NA</p><p class="fields">º/s</p></li>
            <li><p class="fields">Pitch Rate:</p><p class="fields" id="pimupitch_rate">NA</p><p class="fields">º/s</p></li>
            <li><p class="fields">Roll Rate:</p><p class="fields" id="pimuroll_rate">NA</p><p class="fields">º/s</p></li>
        </ul>
    </div>
    <div style="display:inline-block; width: 250px;vertical-align:top;">
        <h3>Batteries</h3>
        <ul>
            <li><p class="fields">Charging:</p><p class="fields" id="pbatcharging">NA</p></li>
            <li><p class="fields">Minimum Cell:</p><p class="fields" id="pbatmin_cell">NA</p><p class="fields">mV</p></li>
            <li><p class="fields">Maximum Cell:</p><p class="fields" id="pbatmax_cell">NA</p><p class="fields">mV</p></li>
            <li><p class="fields">Minimum Temp:</p><p class="fields" id="pbatmin_temp">NA</p><p class="fields">ºC</p></li>
            <li><p class="fields">Maximum Temp:</p><p class="fields" id="pbatmax_temp">NA</p><p class="fields">ºC</p></li>
            <li><p class="fields">Current:</p><p class="fields" id="pbatact_curr">NA</p><p class="fields">mA</p></li>
            <li><p class="fields"># of Packs:</p><p class="fields" id="pbatnum_packs">NA</p></li>
        </ul>
    </div>
    <div style="display:inline-block; width: 200px;vertical-align:top;">
        <h3>Altimeter</h3>
        <ul>
            <li><p class="fields">Data:</p><p class="fields" id="paltdata">NA</p><p class="fields">m</p></li>
            <li><p class="fields">Temperature:</p><p class="fields" id="palttemp">NA</p><p class="fields">ºC</p></li>
        </ul>
    </div>
    <div style="display:inline-block; width: 200px;vertical-align:top;">
        <h3>Depth</h3>
        <ul>
            <li><p class="fields">Data:</p><p class="fields" id="poutpres_pressure">NA</p><p class="fields">mBar</p></li>
            <li><p class="fields">Temperature:</p><p class="fields" id="poutprestemperature">NA</p><p class="fields">ºC</p></li>
        </ul>
    </div>
    <div style="display:inline-block; width: 200px;vertical-align:top;">
        <h3>DVL</h3>
        <ul>
            <li><p class="fields">Heading:</p><p class="fields" id="pdvl_heading">NA</p><p class="fields">º</p></li>
            <li><p class="fields">Pitch:</p><p class="fields" id="pdvl_pitch">NA</p><p class="fields">º</p></li>
            <li><p class="fields">Roll:</p><p class="fields" id="pdvl_roll">NA</p><p class="fields">º</p></li>
        </ul>
    </div>
</body>
</html>
