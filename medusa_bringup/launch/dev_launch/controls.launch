<?xml version="1.0"?>
<launch>

  <env name="ROSCONSOLE_FORMAT" value="[${severity}] [${time}]: ${node}: ${message}"/>

  <!-- Parameters and Arguments -->
  <arg name="name"            /> <!-- Name of the vehicle being launched -->   
  <arg name="config_package"  /> <!-- Name of the package where the configuration files are stored -->
  <arg name="folder"              default="simulation" />  <!-- Name of the folder for the configuration files --> 

  <arg name="inner_loops_forces"  default="false" />   
  <arg name="waypoint"            default="false" />
  <arg name="path_following"      default="false" />
  
  <group ns="controls">

    <!-- Vehicle Specific Config File -->
    <rosparam command="load" file="$(find $(arg config_package))/config/$(arg folder)/$(arg name)/control.yaml" />

    <!-- Launch Nodes that are common to all vehicles -->
    <!-- innerloops: convert dynamic references to thruster force components -->
    <group if="$(arg inner_loops_forces)">
      <node pkg="inner_loops_forces" type="inner_loops_forces" name="inner_loops_forces" output="screen" />
    </group>

    <!-- outerloops: provides kinetic references and vehicle planning behaviors -->
    <!-- waypoint behavior -->
    <group if="$(arg waypoint)">
      <node pkg="waypoint_vx" type="waypoint_vx_node" name="waypoint" output="screen" />
    </group>

    <!-- path following path following controllers   -->
    <group if="$(arg path_following)">
      <node pkg="path_following" type="path_following_node" name="path_following" output="screen" />
    </group>
  </group>
</launch>